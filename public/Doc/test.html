<!-- 马少博  创建于 2017年4月20日09:20:57 -->
<!DOCTYPE html>
<html lang='en'>

<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <link rel='shortcut icon' href='https://raw.githubusercontent.com/OldSixLi/ListPage/master/myapp/public/images/my.ico' />
  <title> 标题</title>
  <!--<link href='http://cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css' rel='stylesheet'>-->
  <!--<link href='../Script/jquery-viewer/viewer.css' rel='stylesheet'>-->
  <link href="../Script/Masonry/style/chromagallery.min.css" rel='stylesheet'>
  <style>
    body,
    html {
      height: 100%;
      background-color: #191919;
    }
    
    .content {
      width: 100%;
      height: 100%;
      margin: 10px auto;
    }
    
    @media screen and (min-width: 980px)
    /* Desktop */
    
    {
      .content {
        width: 70%;
      }
    }
    
    .mygallery {
      margin: 25px 0;
    }
  </style>
</head>

<body>
  <!--<img src="/images/1.jpg" alt="">-->
  <button type="button" class="btn btn-primary" id="btnSpider">开始抓取</button>
  <div id="imgBlock">

  </div>

  <article class="jq22-container">
    <div class="content">
      <div class="chroma-gallery mygallery">
        <!--<img src="images/thumbs/1.jpg" alt="1111111111111" data-largesrc="images/1.jpg">-->

      </div>
    </div>

  </article>
  <!-- 脚本 -->
  <!-- <script src='http://cdn.bootcss.com/angular.js/1.4.1/angular.js'></script> -->

  <script src='http://cdn.bootcss.com/jquery/1.9.1/jquery.min.js'></script>
  <!--<script src='../Script/jquery-viewer/viewer-jquery.min.js'></script>-->
  <script src='../Script/Masonry/scripts/chromagallery.pkgd.min.js'></script>
  <script src='http://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.min.js'></script>
  <script src="//cdnjscn.b0.upaiyun.com/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <script src="../Script/webscoket/socket.io.js"></script>
  <script src="../Script/webscoket/desktopnotify.js"></script>
  <script src="../Script/webscoket/common.js"></script>
  <script>
    var chat_server = 'http://' + location.hostname + ':3000';
    console.log('server: ' + chat_server);
    var socket = io.connect(chat_server);
    socket.on('mashaobo', function(data) {
      alert(data);
      socket.emit('mashaobotest', '前台传输数据成功'); //前台传输数据
    });

    socket.on('ImgData', function(data) {
      $(".chroma-gallery.mygallery").prepend('<img src="' + data + '"></img>'); //后台传输成功的数据
      jihuo();
    });
    $(document).ready(function() {

      // $(document).ready(function() {
      //   $(".mygallery").chromaGallery();
      // });
      // $("#imgBlock").viewer({
      //   transition: false,
      //   navbar: false
      // });

      $("#btnSpider").click(function(e) {
        e.preventDefault();
        $.ajax({
          type: "POST",
          url: "/spider",
          dataType: "json",
          success: function(data) {
            if (data != null && data != "") {
              if (data.success) {
                // tool.alert("提示", "成功");
              } else {
                // tool.alert("提示", "保存失败");
              }
              //获取到数组
              var json = data;
              for (var i = 0; i < json.length; i++) {
                //do something
              }
            } else {
              //failed  do something
            }
          },
          error: function(response) {
            // tool.alert("提示", "请求服务失败,请重试!");
          }
        });
      });


    });

    function jihuo() {
      $(".mygallery").chromaGallery({
        color: '#000',
        gridMargin: 15,
        maxColumns: 5,
        dof: true,
        screenOpacity: 0.8
      });
    }
  </script>
</body>

</html>