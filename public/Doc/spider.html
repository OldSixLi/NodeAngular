<!-- 马少博  创建于 2017年4月20日09:20:57 -->
<!DOCTYPE html>
<html lang='en'>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='shortcut icon' href='https://raw.githubusercontent.com/OldSixLi/ListPage/master/myapp/public/images/my.ico' />
    <title> 标题</title>
    <link href='http://cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css' rel='stylesheet'>
    <link href="../Script/Masonry/style/chromagallery.min.css" rel='stylesheet'>

    <style>
      #container {
        /*display: flex;*/
      }
      
      #container .box {
        width: 16.66%;
        float: left;
      }
      
      .box>img {
        max-width: 100%;
        margin: 5px 0;
      }
      
      .box>img {
        -webkit-animation: cssAnimation 0.4s 1 ease-in;
        -moz-animation: cssAnimation 0.4s 1 ease-in;
        -o-animation: cssAnimation 0.4s 1 ease-in;
        animation: cssAnimation 0.4s 1 ease-in;
      }
      
      @keyframes cssAnimation {
        from {
          transform: rotate(0deg) scale(0.1) skew(0) translate(0);
        }
        to {
          transform: rotate(0deg) scale(1) skew(0) translate(0);
        }
      }
      
      @-webkit-keyframes cssAnimation {
        from {
          -webkit-transform: rotate(0deg) scale(0.1) skew(0) translate(0);
        }
        to {
          -webkit-transform: rotate(0deg) scale(1) skew(0) translate(0);
        }
      }
      
      @-moz-keyframes cssAnimation {
        from {
          -moz-transform: rotate(0deg) scale(0.1) skew(0) translate(0);
        }
        to {
          -moz-transform: rotate(0deg) scale(1) skew(0) translate(0);
        }
      }
      
      @-o-keyframes cssAnimation {
        from {
          -o-transform: rotate(0deg) scale(0.1) skew(0) translate(0);
        }
        to {
          -o-transform: rotate(0deg) scale(1) skew(0) translate(0);
        }
      }
    </style>
  </head>

  <body>
    <div class="container">
      <div class="input-group">
        <input type="text" class="form-control input-lg" id="questionUrl" placeholder="请输入搜索地址">
        <span class="input-group-btn">
        <button class="btn btn-primary btn-lg" type="button" onclick="beginSpider()">　开始抓取　</button>
      </span>
      </div>
      <hr>
    </div>

    <div id="container" class="once container" style="padding-top:20;">
      <div class="box" id="imgblock2"> </div>
      <div class="box" id="imgblock3"> </div>
      <div class="box" id="imgblock4"> </div>
      <div class="box" id="imgblock5"> </div>
      <div class="box" id="imgblock6"> </div>
      <div class="box" id="imgblock1"> </div>

    </div>
    <div id="zancun">
    </div>
    <!-- 脚本 -->
    <script src='http://cdn.bootcss.com/jquery/1.9.1/jquery.min.js'></script>
    <script src='../Script/Masonry/scripts/chromagallery.pkgd.min.js'></script>
    <script src='http://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.min.js'></script>
    <script src="//cdnjscn.b0.upaiyun.com/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script src="../Script/webscoket/socket.io.js"></script>
    <script src="../Script/webscoket/desktopnotify.js"></script>
    <script src="../Script/webscoket/common.js"></script>
    <script>
      var chat_server = 'http://' + location.hostname + ':3001';
      console.log('server: ' + chat_server);
      var socket = io.connect(chat_server);
      var imgIndex = 1;

      //webscoket相关代码
      socket.on('mashaobo', function(data) {
        socket.emit('mashaobotest', '前台传输数据成功'); //前台传输数据
        socket.emit('FileWatch', '前台传输数据成功'); //前台传输数据

      });

      // socket.on('FileChange', function(data) {
      //   // socket.emit('mashaobotest', '前台传输数据成功'); //前台传输数据
      //   //刷新当前页面.
      //   window.location.reload();
      // }); 
      var settime = 0,
        str = "";
      socket.on('ImgData', function(data) {
        if (data) {
          settime++;
          str = "<img src=" + data + "  class='img-responsive img-thumbnail'>";　
        }

        var yushu = settime % 6 + 1;　
        var obj = {},
          　arr = [];

        obj[$("#imgblock1").height()] = '#imgblock1';
        obj[$("#imgblock2").height()] = '#imgblock2';
        obj[$("#imgblock3").height()] = '#imgblock3';
        obj[$("#imgblock4").height()] = '#imgblock4';
        obj[$("#imgblock5").height()] = '#imgblock5';
        obj[$("#imgblock6").height()] = '#imgblock6';

        arr.push($("#imgblock1").height());
        arr.push($("#imgblock2").height());
        arr.push($("#imgblock3").height());
        arr.push($("#imgblock4").height());
        arr.push($("#imgblock5").height());
        arr.push($("#imgblock6").height());
        console.log("↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓");
        console.log('当前高度为：' + arr.join(','));
        console.log("↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑");
        var minnum = Math.min.apply(Math, arr);

        var selectors = obj[minnum];
        console.log("↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓");
        console.log("最小的是：" + selectors);
        console.log("↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑");
        $(selectors).append(str)　　
      });

      function beginSpider() {
        var word = $("#questionUrl").val();
        if (!word) {
          alert("请输入内容");
        } else {
          if (word.indexOf('www.zhihu.com')) {
            word = word.substr(word.lastIndexOf('/') + 1);
          }
          socket.emit('SpiderBegin', word);
        }

      }
    </script>
  </body>

</html>