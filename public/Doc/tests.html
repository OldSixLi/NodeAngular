<!DOCTYPE html>




<html lang="en">

  <head>
    <!-- jsp文件头和头部 -->






    <base href="http://www.htyfw.com.cn:80/csfwpt_console/">
    <meta charset="utf-8">
    <link rel="shortcut icon" href="static/favicon.ico" type="image/x-icon" />
    <title>神州浩天智慧财税服务支撑平台</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 引入 ZTree -->
    <link rel="stylesheet" href="static/common/frame/ztree/css/zTreeStyle/zTreeStyle.css" type="text/css"></link>
    <link rel="stylesheet" href="static/common/frame/ztree/css/metroStyle/metroStyle.css" type="text/css"></link>
    <!-- 引入Bootstrap CSS -->
    <link rel="stylesheet" href="static/common/frame/weui/css/weui.css" type="text/css">
    <link rel="stylesheet" href="static/common/frame/bootstrap/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="static/common/frame/jquery-confirm/jquery-confirm.min.css" type="text/css">
    <link rel="stylesheet" href="static/common/frame/bootstrap/icheck/skins/all.css" type="text/css">
    <link rel="stylesheet" href="static/common/frame/bootstrap/select/css/select2.min.css" type="text/css">
    <link rel="stylesheet" href="static/common/frame/bootstrap/switch/css/bootstrap-switch.min.css" type="text/css">
    <!-- link rel="stylesheet" href="static/common/frame/flat/css/flat-ui.min.css" type="text/css" -->
    <link rel="stylesheet" href="static/common/frame/bootstrap/datetimepicker/css/bootstrap-datetimepicker.min.css" type="text/css">
    <link rel="stylesheet" href="static/common/frame/bootstrap/slider/css/bootstrap-slider.min.css" type="text/css">
    <!-- 项目核心 CSS -->
    <link rel="stylesheet" href="static/common/css/csfwpt.css" type="text/css">
    <!-- 引入jQuery -->
    <script type="text/javascript" src="static/common/frame/jquery/jquery-1.11.3.min.js"></script>
    <!-- 引入Bootstrap -->
    <script type="text/javascript" src="static/common/frame/bootstrap/js/bootstrap.min.js"></script>
    <!--  FOR IE BEGIN -->
    <!-- IE8 -->
    <!--[if lt IE 9]>
<script src="static/common/frame/bootstrap/assets/js/ie8-responsive-file-warning.js"></script>
<![endif]-->
    <script src="static/common/frame/bootstrap/assets/js/ie-emulation-modes-warning.js"></script>

    <!--[if lt IE 9]>
<script src="static/common/frame/bootstrap/assets/js/html5shiv.min.js"></script>
<script src="static/common/frame/bootstrap/assets/js/respond.min.js"></script>
<![endif]-->
    <!-- FOR IE END -->
    <script type="text/javascript" src="static/common/frame/echarts/echarts.min.js"></script>
    <script type="text/javascript" src="static/common/frame/ztree/jquery.ztree.all.js"></script>
    <script type="text/javascript" src="static/common/frame/bootstrap/icheck/icheck.min.js"></script>
    <script type="text/javascript" src="static/common/frame/bootstrap/select/js/select2.js"></script>
    <script type="text/javascript" src="static/common/frame/bootstrap/switch/js/bootstrap-switch.min.js"></script>
    <script type="text/javascript" src="static/common/frame/bootstrap/js/bootstrap-paginator.min.js"></script>
    <script type="text/javascript" src="static/common/frame/bootstrap/filestyle/bootstrap-filestyle.min.js"></script>
    <!-- script type="text/javascript" src="static/common/frame/flat/js/flat-ui.min.js"></script -->
    <script type="text/javascript" src="static/common/frame/jquery-confirm/jquery-confirm.min.js"></script>
    <script type="text/javascript" src="static/common/frame/bootstrap/datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
    <script type="text/javascript" src="static/common/frame/bootstrap/datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>
    <script type="text/javascript" src="static/common/frame/bootstrap/slider/js/bootstrap-slider.min.js"></script>
    <script type="text/javascript" src="static/common/frame/json/json2.js"></script>
    <script type="text/javascript" src="static/common/frame/bootstrap/bootbox/bootbox.min.js"></script>
    <!-- 文件上传js -->
    <script type="text/javascript" src="static/file/upload-file.js"></script>
    <!-- 发票工具 JS -->
    <script type="text/javascript" src="static/sell/invoice/invoicetool.js"></script>
    <!-- 项目核心 JS -->
    <script type="text/javascript" src="static/common/js/xss.js"></script>
    <script type="text/javascript" src="static/common/js/csfwpt.js"></script>
    <script type="text/javascript">
      var resourceHost = "http://zy.htyfw.com.cn/resCenter/";
    </script>
    <!-- DWR实时消息 JS -->
    <script type='text/javascript' src="/csfwpt_console/dwr/engine.js"></script>
    <script type='text/javascript' src="/csfwpt_console/dwr/util.js"></script>
    <script type='text/javascript' src="/csfwpt_console/dwr/interface/ChatManager.js"></script>
    <script type='text/javascript' src="/csfwpt_console/dwr/interface/CheckSession.js"></script>




    <style type="text/css">
      .form-group {
        position: relative;
      }
      
      .blue {
        color: #06c;
      }
      
      .cuowei {
        position: absolute;
        right: 100px;
        top: 7px;
        font-size: 1.5em;
      }
      
      .tabble-block {
        min-height: 200px;
        margin-top: 20px;
      }
      
      .checkForm span {
        margin-right: 30px;
      }
      
      .hidden-copy {
        opacity: 0;
        position: absolute;
        left: -1000px;
      }
      
      .copy {
        margin-top: 17px;
      }
      
      .copy-btn {
        font-size: 12px;
        width: 130px;
        height: 30px;
        background-color: #6699ff;
        border-color: #6699ff;
      }
    </style>
  </head>

  <body class="sticky-header">
    <div class="header container-fluid">
      <div class="row">
        <ol class="breadcrumb col-xs-8">
          <li><a href="javascript:;">客户管理</a>
          </li>
          <li class="active">客户授权号查询</li>
        </ol>
      </div>
    </div>
    <div class="workframe">
      <div class="container-fluid">
        <div class="row">
          <div class="col-xs-12">
            <br/>
            <div class="form-horizontal" role="form">
              <div class="form-group" id="pare1">
                <label for="name" class="col-sm-2 control-label"><span class="glyphicon glyphicon-arrow-right blue cuowei"  style="display:none" id="ss1">&nbsp;</span>纳税人识别号：</label>
                <div class="col-sm-10" id="query1">
                  <input class="form-control" type="text" name="nsrsbh" placeholder="请输入要查询的纳税人识别号、统一社会信用代码" maxlength="50" id="searchNum" />
                </div>
              </div>
              <br/>
              <button class="col-xs-offset-2 col-xs-8 btn btn-md btn-primary" id="search">查询</button>
            </div>
            <div class="tabble-block col-xs-12">
              <table class="table" id="searchTable">
                <thead>
                  <tr>
                    <th style="width: 130px;">纳税人识别号</th>
                    <th style="width:195px;">纳税人名称</th>
                    <th style="width:115px;">光盘号码</th>
                    <th style="width:250px;">授权号码</th>
                    <th style="width:100px;">授权号类别</th>
                  </tr>
                </thead>
                <tbody id="tBodyResult">
                </tbody>
              </table>
            </div>
            <input type="button" value="复制到剪贴板" style="margin-left:10px;" class="btn btn-primary pull-right copy-btn" id="toCopy">
            <input type="button" value="打印授权号" class="btn btn-primary pull-right copy-btn" id="toPrint">
            <input type="text" name="copyvalue" value="0" class="form-control hidden-copy" id="copyvalue">
          </div>
        </div>
      </div>
    </div>
    <div style="display: none;"><iframe name="hideFrame" src="static/authorization/authorization.html"></iframe></div>
  </body>
  <script>
    //全部变量
    var printData = "";
    window.onload = function(event) {
      var button = document.getElementById("toCopy");
      button.onclick = function(event) {

        if (window.clipboardData) {
          window.clipboardData.clearData();
          clipboardData.setData("Text", $.trim($("#copyvalue").val()));
        } else {
          document.getElementById("copyvalue").select();
          document.execCommand("copy");
        }
        var num = $.trim($("#searchNum").val());
        if ($("#searchTable").find("tr").length == 1 || $("#searchTable").find("tr").eq(1).find("td").size() == 1) {
          tool.alert("提示", "没有需要复制的内容");
        } else {
          tool.alert("提示", "复制成功");
        }
      };
    };

    $(function() {
      // 按钮查询
      $("#search").click(function() {
        var num = $.trim($("#searchNum").val());
        if (num == "") {
          printData = "";
          showFiled("nonum");
        } else {
          search(num);
        }
      });

      // 回车查询
      $("#searchNum").keydown(function(e) {
        if (e.keyCode == 13) {
          var num = $.trim($("#searchNum").val());
          if (num == "") {
            printData = "";
            showFiled("nonum");
          } else {
            search(num);
          }
        }
      });
    });

    // 查询请求接口操作
    function search(num) {
      $.ajax({
        url: "/csfwpt_console/queryAuthorization/queryAuthorizationByNsrsbh?nsrsbh=" + num,
        dataType: "JSON",
        type: "GET",
        success: function(data) {
          if (data != null && data != "" && data.success && data.bean != null && data.bean != "") {
            var json = data.bean;
            var htmlStr = "";
            var val = '';
            if (json.length > 0) {
              printData = json;
              console.info(printData);
              var copyStr = 'greatchn ' + json[0].nsrsbh;
              for (var i = 0; i < json.length; i++) {
                var obj = json[i];
                var sqlxval = obj.sqlx;
                if (obj.sqlx == "R") {
                  obj.sqlx = "介质申报";
                } else if (obj.sqlx == "W") {
                  obj.sqlx = "网上申报";
                }
                copyStr += '|' + sqlxval + ',' + obj.gphm + ',' + obj.sqhm
                htmlStr += "<tr><td>" + obj.nsrsbh + "</td><td>" + obj.nsrsmc + "</td><td>" + obj.gphm + "</td><td>" + obj.sqhm + "</td><td>" + obj.sqlx + "</td></tr>";
                val += obj.nsrsbh + " " + obj.nsrsmc + " " + obj.gphm + " " + obj.sqhm + " " + obj.sqlx + " ";
              }
              copyStr += " tax_software";
            }
            $("#tBodyResult").html(htmlStr);
            $("#copyvalue").val(copyStr);
          } else {
            showFiled("noResult");
            printData = "";
          }
        },
        error: function(data) {
          showFiled("noResult");
          printData = "";
        }
      }).done(function(data) {
        $(":button").attr("disabled", false);
      });
    }
    //展示信息
    function showFiled(type) {
      if ("noResult" == type) {
        $("#tBodyResult").html("<tr><td colspan='5' align='center'><font size='5' color='red'>没有查到对应的授权号信息</font></td></tr>");
      } else {
        tool.alert("提示", "纳税人识别号不能空");
        $("#tBodyResult").html('');
      }
    }
    //打印
    $("#toPrint").click(function() {
      var nsrmc = "";
      if (printData != null && printData != "") {
        nsrmc = printData[0].nsrsmc;
        var qymc = $(window.frames["hideFrame"].document).find("#qymc");
        var tabContent = $(window.frames["hideFrame"].document).find("#tabContent");
        $(qymc).html(nsrmc);
        var html = "";
        for (var i = 0; i < printData.length; i++) {
          var obj = printData[i];
          var sqlxval = obj.sqlx;
          var gphm = obj.gphm;
          if (obj.sqlx == "R") {
            sqlxval = "软盘授权号";
          } else if (obj.sqlx == "W") {
            sqlxval = "网报授权号";
          }
          html += "<tr>" +
            "<td class='left_td font'>光盘号：</td>" +
            "<td class='right_td font'>" + gphm + "</td>" +
            "</tr>";
          html += "<tr>" +
            "<td class='left_td font'>" + sqlxval + "</td>" +
            "<td class='right_td font'>" + obj.sqhm + "</td>" +
            "</tr>";
          html += "<td colspan='2'>&nbsp;</td>";
        }
        $(tabContent).html(html);
        window.frames["hideFrame"].print();
      } else {
        tool.alert("提示", "请先查询到授权号信息，在执行打印操作");
      }
    });
  </script>

</html>