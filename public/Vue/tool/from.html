<!-- 马少博  创建于 时间 -->
<!DOCTYPE html>
<html lang='en'>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='shortcut icon' href='https://raw.githubusercontent.com/OldSixLi/ListPage/master/public/images/my.ico' />
    <title> 标题</title>
    <link href='http://cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="../../Style/vue-index.css">
    <link rel="stylesheet" href="../../Style/vue-base.css">
    <style>
      .error {
        /* height: 0;*/
        /* display: none; */
      }
      
      .error.active {
        animation: cssAnimation .3s 1 ease forwards;
      }
      
      @keyframes cssAnimation {
        from {
          display: none;
          height: 0;
          transform: scale(1, 0);
        }
        to {
          display: block;
          height: 100%;
          transform: scale(1);
        }
      }
    </style>
  </head>

  <body>


    <!--NOTE 此处声明Vue-->
    <div id="vueBlock">
      <!-- <h1 class="error active" v-if="isshow">你们说的事情</h1>
      <button type="button" class="btn btn-primary" @click="addClass">添加样式</button> -->
      <!-- <h1 class="text-center">FORM表单组件</h1> -->
      <br>
      <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
          <!-- 行内布局 -->
          <h3 class="text-center">行内布局</h3>
          <ht-form :inline="true" class="text-center">
            <ht-form-item label="你好">
              <ht-input type="text" v-model="form.zhoujielun" class="form-control" placeholder="请输入金额"></ht-input>
            </ht-form-item>
            <ht-form-item label="你好">
              <ht-input type="text" v-model="form.zhoujielun" class="form-control" placeholder="请输入金额"></ht-input>
            </ht-form-item>
            <ht-form-item>
              <button type="button" class="btn btn-primary">搜索</button>
            </ht-form-item>
          </ht-form>

          <!-- 表单布局 -->
          <h3 class="text-center">表单布局</h3>
          <ht-form :model="form" label-width="100px" label-position="right" style="width:900px;margin:0 auto;">
            <!-- Begin -->
            <label>一人一首成名曲：</label>
            <ht-form-item label="周杰伦：" validateMessage="请输入歌曲名" isRequired="true">
              <ht-input type="text" v-model="form.zhoujielun" class="form-control" placeholder="请输入金额"></ht-input>
            </ht-form-item>

            <ht-form-item label="苏阳：">
              <ht-input type="text" v-model="form.suyang" class="form-control" placeholder="请输入金额"></ht-input>
            </ht-form-item>

            <ht-form-item label="帕瓦罗蒂：" class="multi-input">
              <ht-input type="text" v-model="form.pawaluodi" style="width:45%;" placeholder="请输入金额"></ht-input>
              <label style="width: 10%;text-align: center;">至</label>
              <ht-input type="text" v-model="form.pawaluodi" style="width:45%;" placeholder="请输入金额"></ht-input>
            </ht-form-item>

            <ht-form-item label="是否购买：">
              <ht-radio v-model="form.isBuy" label="YES">是</ht-radio>
              <ht-radio v-model="form.isBuy" label="NO">否</ht-radio>
              <label class="pull-right">{{form.isBuy=="YES"?"他要买":"他不买"}}</label>
            </ht-form-item>

            <ht-form-item label="具体歌词：">
              <textarea name="" id="" rows="10" class="form-control"></textarea>
            </ht-form-item>

            <ht-form-item class="text-center">
              <button type="submit" class="btn btn-primary">保存</button>
              <button type="button" class="btn btn-default">取消</button>
              <button type="button" class="btn btn-danger pull-right" @click="resertForm()">重置表单</button>
            </ht-form-item>
            <!-- End -->
          </ht-form>

        </div>
        <div class="col-md-2"></div>
      </div>




    </div>

    <!-- 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　
　　　◆　　　◆　◆　　　　　◆　　　　　　◆◆　　　　　　　　　　　　　　　　　　　　　　　　　　　
　　　◆　◆◆◆◆◆◆◆　　　◆　　◆◆◆◆　　　　　　　　　　　　　　　　　　　　　　　　　　　　　
　　　◆　　　◆　◆　　　　　◆　　◆　　　　　　　◆◆　　◆◆◆◆◆◆◆◆◆◆　◆◆◆◆◆◆　　　　
　◆◆◆◆　◆◆◆◆◆　　◆◆◆◆　◆　　　　　　　　◆　　◆　◆　◆　◆　◆◆　◆◆　　◆　　　　　
　　　◆　　◆　　　◆　　　　◆　　◆◆◆◆◆◆　　　◆　　◆　　　◆　　　◆◆　◆◆　　◆　　　　　
　　◆◆　　◆◆◆◆◆　　　◆◆◆　◆　◆　　◆　　　◆◆◆◆　　　◆　　　◆◆　◆◆　　◆　　　　　
　　◆◆◆　◆　　　◆　　　◆◆　◆◆　◆　　◆　　　◆　　◆　　　◆　　　◆　◆　◆　　◆　　　　　
　◆　◆　　◆◆◆◆◆　　◆　◆　　◆　◆　◆　　　　◆　　◆　　　◆　　　◆　◆　◆　　◆　　　　　
　　　◆　　　　◆　　　　　　◆　　◆　◆　◆　　　　◆　　◆　　　◆　　　◆　◆　◆　　◆　　　◆　
　　　◆　◆◆◆◆◆◆◆　　　◆　　◆　　◆　　　　◆◆　　◆◆　◆◆◆　◆◆　◆　◆◆◆◆◆◆◆◆　
　　　◆　　　◆　◆　　　　　◆　◆　　◆　◆　　　　　　　　　　　　　　　　　　　　　　　　　　　　
　　　◆　◆◆　　　◆◆　　　◆◆　　◆　　　◆　　　　　　　　　　　　　　　　　　　　　　　　　　　
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 -->
    <!-- NOTE 模板HTML Begin-->
    <!-- FORM表单 -->
    <script type="text/x-template" id="ht-form">
      <form class="el-form" :class="[
            labelPosition ? 'el-form--label-' + labelPosition : '',
            { 'el-form--inline': inline }
          ]">
        <slot></slot>
      </form>
    </script>
    <!-- FORM-ITEM 子选项-->
    <script type="text/x-template" id="ht-form-item">
      <div class="el-form-item" :class="{
            'is-error': validateState === 'error',
            'is-validating': validateState === 'validating',
            'is-required': isRequired || required
          }">
        <label :for="prop" class="el-form-item__label" v-bind:style="labelStyle" v-if="label">
              <slot name="label">{{label + form.labelSuffix}}</slot>
            </label>
        <div class="el-form-item__content" v-bind:style="contentStyle">
          <slot></slot>
          <transition name="el-zoom-in-top">
            <div class="el-form-item__error" v-if="validateState === 'error' && showMessage && form.showMessage">{{validateMessage}}</div>
          </transition>
        </div>
      </div>
    </script>
    <!-- NOTE 模板HTML End-->

    <!-- 脚本 -->
    <script src='https://cdn.bootcss.com/vue/2.3.3/vue.js'></script>
    <script src='http://cdn.bootcss.com/jquery/1.9.1/jquery.min.js'></script>
    <script src='http://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.min.js'></script>
    <script src='../../Script/vue/component.js'></script>
    <script>
      // $(document).ready(function() {
      //   $(".error").addClass("active");
      // });

      // 　◆◆◆◆◆　　◆◆◆　　◆◆◆◆　◆◆◆　◆◆◆　
      // 　　◆　　◆　◆　　　◆　　◆　　◆　◆◆　◆◆　　
      // 　　◆　◆　　◆　　　◆　　◆　　◆　◆◆　◆◆　　
      // 　　◆◆◆　　◆　　　◆　　◆◆◆　　◆◆　◆◆　　
      // 　　◆　◆　　◆　　　◆　　◆　◆　　◆　◆　◆　　
      // 　　◆　　　　◆　　　◆　　◆　　◆　◆　◆　◆　　
      // 　　◆　　　　◆　　　◆　　◆　　◆　◆　◆　◆　　
      // 　◆◆◆　　　　◆◆◆　　◆◆◆　◆◆◆　◆　◆◆
      // form组件
      Vue.component('ht-form', {
        template: '#ht-form',
        //组件生成时调用
        mounted: function() {},
        //对外获取的数据
        props: {
          model: Object,
          rules: Object,
          labelPosition: String,
          labelWidth: String,
          labelSuffix: {
            type: String,
            default: ''
          },
          inline: Boolean,
          showMessage: {
            type: Boolean,
            default: true
          }
        },
        watch: {
          rules() {
            this.validate();
          }
        },
        //组件内数据部分
        data() {
          return {
            fields: []
          };
        },
        created() {
          this.$on('el.form.addField', (field) => {
            if (field) {
              this.fields.push(field);
            }
          });
          /* istanbul ignore next */
          this.$on('el.form.removeField', (field) => {
            if (field.prop) {
              this.fields.splice(this.fields.indexOf(field), 1);
            }
          });
        },
        methods: {
          resetFields() {
            this.fields.forEach(field => {
              field.resetField();
            });
          },
          validate(callback) {
            let valid = true;
            let count = 0;
            // 如果需要验证的fields为空，调用验证时立刻返回callback
            if (this.fields.length === 0 && callback) {
              callback(true);
            }
            this.fields.forEach((field, index) => {
              field.validate('', errors => {
                if (errors) {
                  valid = false;
                }
                if (typeof callback === 'function' && ++count === this.fields.length) {
                  callback(valid);
                }
              });
            });
          },
          validateField(prop, cb) {
            var field = this.fields.filter(field => field.prop === prop)[0];
            if (!field) {
              throw new Error('must call validateField with valid prop string!');
            }

            field.validate('', cb);
          }
        }
      });
      //       　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　
      // 　　　◆◆　　　　　　　　　　　　　　　　　　　　　　　　　　　◆　　　　　　　　　　　　　　　　　　　　　
      // 　　◆　　◆　　　　　　　　　　　　　　　　　　　　　　　　　　◆　　　　　　　　　　　　　　　　　　　　　
      // 　　◆　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　◆　　　　　　　　　　　　　　　
      // 　　◆　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　◆　　　　　　　　　　　　　　　
      // 　◆◆◆◆　　　◆◆　　◆◆　◆◆　◆◆◆◆　　◆◆◆◆◆◆　◆◆　　　　◆◆◆◆　　　◆◆　　◆◆◆◆　　
      // 　　◆　　　　◆　　◆　　◆◆　　　◆　◆　◆　　　　　　　　　◆　　　　　◆　　　　◆　　◆　◆　◆　◆　
      // 　　◆　　　　◆　　◆　　◆　　　　◆　◆　◆　　　　　　　　　◆　　　　　◆　　　　◆◆◆◆　◆　◆　◆　
      // 　　◆　　　　◆　　◆　　◆　　　　◆　◆　◆　　　　　　　　　◆　　　　　◆　　　　◆　　　　◆　◆　◆　
      // 　◆◆◆◆　　　◆◆　　◆◆◆　　　◆　◆　◆　　　　　　　　◆◆◆　　　　◆◆◆　　　◆◆◆　◆　◆　◆　
      // form-tiem组件
      Vue.component('ht-form-item', {
        template: '#ht-form-item',
        props: {
          label: String,
          labelWidth: String,
          prop: String,
          required: Boolean,
          rules: [Object, Array],
          error: String,
          validateStatus: String,
          showMessage: {
            type: Boolean,
            default: true
          }
        },

        //组件内数据部分
        computed: {
          labelStyle() {
            var ret = {};
            if (this.form.labelPosition === 'top') return ret;
            var labelWidth = this.labelWidth || this.form.labelWidth;
            if (labelWidth) {
              ret.width = labelWidth;
            }
            return ret;
          },
          contentStyle() {
            var ret = {};
            if (this.form.labelPosition === 'top' || this.form.inline) return ret;
            var labelWidth = this.labelWidth || this.form.labelWidth;
            if (labelWidth) {
              ret.marginLeft = labelWidth;
            }
            return ret;
          },
          form() {
            var parent = this.$parent;
            while (parent.$options._componentTag !== 'ht-form') {
              parent = parent.$parent;
            }
            return parent;
          },
          fieldValue: {
            cache: false,
            get() {
              var model = this.form.model;
              if (!model || !this.prop) {
                return;
              }

              var path = this.prop;
              if (path.indexOf(':') !== -1) {
                path = path.replace(/:/, '.');
              }
              return getPropByPath(model, path).v;
            }
          }
        },
        data() {
          return {
            validateState: '',
            validateMessage: '',
            validateDisabled: false,
            validator: {},
            isRequired: false
          };
        },
        methods: {
          dispatch(componentName, eventName, params) {
            var parent = this.$parent || this.$root;
            var name = parent.$options.componentName;

            while (parent && (!name || name !== componentName)) {
              parent = parent.$parent;

              if (parent) {
                name = parent.$options.componentName;
              }
            }
            if (parent) {
              parent.$emit.apply(parent, [eventName].concat(params));
            }
          },
          broadcast(componentName, eventName, params) {
            broadcast.call(this, componentName, eventName, params);
          },
          validate(trigger, callback = noop) {
            var rules = this.getFilteredRule(trigger);
            if (!rules || rules.length === 0) {
              callback();
              return true;
            }
            this.validateState = 'validating';
            var descriptor = {};
            descriptor[this.prop] = rules;

            var validator = new AsyncValidator(descriptor);
            var model = {};

            model[this.prop] = this.fieldValue;

            validator.validate(model, {
              firstFields: true
            }, (errors, fields) => {
              this.validateState = !errors ? 'success' : 'error';
              this.validateMessage = errors ? errors[0].message : '';
              callback(this.validateMessage);
            });
          },
          resetField() {
            this.validateState = '';
            this.validateMessage = '';

            let model = this.form.model;
            let value = this.fieldValue;
            let path = this.prop;
            if (path.indexOf(':') !== -1) {
              path = path.replace(/:/, '.');
            }

            let prop = getPropByPath(model, path);

            if (Array.isArray(value)) {
              this.validateDisabled = true;
              prop.o[prop.k] = [].concat(this.initialValue);
            } else {
              this.validateDisabled = true;
              prop.o[prop.k] = this.initialValue;
            }
          },
          getRules() {
            var formRules = this.form.rules;
            var selfRuels = this.rules;

            formRules = formRules ? formRules[this.prop] : [];

            return [].concat(selfRuels || formRules || []);
          },
          getFilteredRule(trigger) {
            var rules = this.getRules();

            return rules.filter(rule => {
              return !rule.trigger || rule.trigger.indexOf(trigger) !== -1;
            });
          },
          onFieldBlur() {
            this.validate('blur');
          },
          onFieldChange() {
            if (this.validateDisabled) {
              this.validateDisabled = false;
              return;
            }
            this.validate('change');
          }
        },
        //组件生成时调用
        mounted() {
          if (this.prop) {
            this.dispatch('ht-form', 'el.form.addField', [this]);

            let initialValue = this.fieldValue;
            if (Array.isArray(initialValue)) {
              initialValue = [].concat(initialValue);
            }
            Object.defineProperty(this, 'initialValue', {
              value: initialValue
            });
            let rules = this.getRules();
            if (rules.length) {
              rules.every(rule => {
                if (rule.required) {
                  this.isRequired = true;
                  return false;
                }
              });
              this.$on('el.form.blur', this.onFieldBlur);
              this.$on('el.form.change', this.onFieldChange);
            }
          }
        },
        beforeDestroy() {
          this.dispatch('ht-form', 'el.form.removeField', [this]);
        }
      });

      function broadcast(componentName, eventName, params) {
        this.$children.forEach(function(child) {
          var name = child.$options.componentName;
          if (name === componentName) {
            child.$emit.apply(child, [eventName].concat(params));
          } else {
            broadcast.apply(child, [componentName, eventName].concat([params]));
          }
        });
      }

      function noop() {}

      function getPropByPath(obj, path) {
        let tempObj = obj;
        path = path.replace(/\[(\w+)\]/g, '.$1');
        path = path.replace(/^\./, '');

        let keyArr = path.split('.');
        let i = 0;

        for (let len = keyArr.length; i < len - 1; ++i) {
          let key = keyArr[i];
          if (key in tempObj) {
            tempObj = tempObj[key];
          } else {
            throw new Error('please transfer a valid prop path to form item!');
          }
        }
        return {
          o: tempObj,
          k: keyArr[i],
          v: tempObj[keyArr[i]]
        };
      }

      　　　　　　　　　　　　　　　　　　　　　　　　　　



      // 　　　　　　　　　　　　　　　　　　　　　　　　　◆　　　　　　◆◆◆◆◆　◆◆◆◆◆　
      // 　　　　　　　　　　　　　　　　　　　　◆◆◆◆◆◆◆◆◆◆◆　◆　　　◆　◆　　　◆　
      // 　◆◆　　◆◆◆◆　　◆◆◆◆◆◆◆　　　　　　　◆　　　　　　◆　　　◆　◆　　　◆　
      // 　　◆　　◆　　◆　　◆　　◆　　◆　　　◆◆◆◆◆◆◆◆◆　　◆　　　◆　◆◆◆◆◆　
      // 　　◆　　◆　　◆　　◆　　◆　◆　　　　　　　　　　　　　　　◆◆◆◆◆　◆　　　◆　
      // 　　◆　◆　　　◆　　◆　　◆◆◆　　　　◆◆◆◆◆◆◆◆◆　　◆　　　◆　◆　　　◆　
      // 　　◆　◆　　　◆　　◆　　◆　◆　　　　◆　　　◆　　　◆　　◆　　　◆　◆◆◆◆◆　
      // 　　　◆◆　　　◆　　◆　　◆　　　　　　◆　　　◆　　　◆　　◆　　　◆　◆　　　◆　
      // 　　　◆　　　　◆　　◆　　◆　　◆　　　◆◆◆◆◆◆◆◆◆　　◆◆◆◆◆　◆　　　◆　
      // 　　　◆　　　　　◆◆　　◆◆◆◆◆　　　◆　　　　　　　◆　　◆　　　　　◆　　　◆　
      // 　　　　　　　　　　　　　　　　　　　　　◆　　　　　　　　　　　　　　　◆　　　　◆　
      // 　　　　　　　　　　　　　　　　　　　　◆　　　　　　　　　　　　　　　◆　　　◆◆◆　
      var vueBlock = new Vue({
        el: "#vueBlock",
        //数据部分
        data: {
          isshow: false,
          form: {
            zhoujielun: '双节棍',
            suyang: '贺兰山下',
            pawaluodi: '我的太阳',
            isBuy: 'NO'
          }
        },
        //方法
        methods: {
          resertForm: function() {
            this.form = {
              zhoujielun: '',
              suyang: '',
              pawaluodi: '',
              isBuy: 'NO'
            }
          },
          addClass: function() {
            this.isshow = !this.isshow;
          }
        },
        //过滤器
        filters: {},
        //实时计算
        computed: {},
        //加载后立即执行的方法(created 这个钩子在实例被创建之后被调用)
        created: function() {}
      });
    </script>
  </body>

</html>