var express=require("express"),qiniu=require("qiniu"),router=express.Router(),fs=require("fs"),multiparty=require("multiparty"),util=require("util"),path=require("path"),answer=require("./test"),answer=require("../NodeCode/zhihu/answer");router.get("/",function(e,r,o){r.render("index")}),router.all("/tree",function(e,r,o){var s=fs.readFileSync("/PersonCodes/ListPage/public/JSON/tree.json","utf-8"),i=JSON.parse(s);setTimeout(function(){r.json(i)},0)}),router.post("/upload",function(e,r,o){try{var s=path.resolve(__dirname,"../public/images/upload/"),i;new multiparty.Form({uploadDir:s}).parse(e,function(e,o,s){var i=JSON.stringify(s,null,2);if(e){console.log("parse error: "+e);var a={success:!1,message:"解析错误！"};r.json(a)}else{var t;if(console.log("上传路径为: "+i),(s.imageRes?s.imageRes.length:0)>0){var n=s.imageRes[0],u=n.path,a={success:!0,message:u=u.substr(n.path.indexOf("public")+6)};r.json(a)}}})}catch(e){console.log(e)}}),qiniu.conf.ACCESS_KEY="gfmlM2ZmBqZkpPZixYkPzb2zy-FbJv2mvR1KY3t_",qiniu.conf.SECRET_KEY="7ksC_gm9kaNmUHMaphcypwFK3nWzafwbxNKLxaNN",router.get("/token",function(e,r,o){var s,i=new qiniu.rs.PutPolicy("hes-upload").token();r.header("Cache-Control","max-age=0, private, must-revalidate"),r.header("Pragma","no-cache"),r.header("Expires",0),i&&r.json({uptoken:i})}),router.all("/spider",function(e,r,o){console.log("↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓"),console.log("开始执行此方法"),console.log("↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑")}),module.exports=router;